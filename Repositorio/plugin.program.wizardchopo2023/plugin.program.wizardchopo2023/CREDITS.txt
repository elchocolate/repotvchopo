Many thanks to drinfernoo, SerpentDrago and Slamious who did the real work.